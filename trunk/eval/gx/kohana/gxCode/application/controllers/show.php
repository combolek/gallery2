<?php
class Show_Controller extends Gallery_Controller {
    // Set the name of the template to use
    public $template = 'templates/jacob';

    public function Album($id=1) {
	// In Kohana, all views are loaded and treated as objects.
	$this->template->header->active = "Browse Photos";
	$this->template->content = new View('show_album');

	$item = new Item_Model($id);
	$children = new Item_Model();
	$children = $children->where('Parent', $item->Id)->limit(9)->find_all();

	$this->template->content->item = $item;
	$this->template->content->maxRows = 3;
	$this->template->content->maxColumns = 3;
	$this->template->content->children = $children;
    }

    public function Item($parentId, $id) {
	// In Kohana, all views are loaded and treated as objects.
	$this->template->header->active = "Browse Photos";
	$this->template->content = new View('show_item');

	$item = new Item_Model($id);
	
	$path = '';
	while (!empty($parentId)) {
	    $parent = new Item_Model($parentId);
	    $path = $parent->Path . '/' . $path;
	    $parentId = $parent->Parent;
	}

	$this->template->content->path = $path;
	$this->template->content->item = $item;
	$this->template->content->parentId = $parent;
    }

    public function __call($method, $arguments) {
	// Disable auto-rendering
	$this->auto_render = FALSE;

	// By defining a __call method, all pages routed to this controller
	// that result in 404 errors will be handled by this method, instead of
	// being displayed as "Page Not Found" errors.
	echo 'This text is generated by __call. If you expected the index page, you need to use: welcome/index/' . Router::$current_uri;
    }
}
?>