#!/bin/sh

case $1 in
	html)
		echo "Generating HTML Manual...";
		
		if [ ! -d html ]; then
			mkdir html;
		fi

		cd html
		xsltproc ../docbook-xsl/html/chunk.xsl ../manual.xml;;

	bightml)
		echo "Generating Big HTML Manual...";

		if [ -e manual.html ]; then
			rm -f manual.html;
		fi

		xsltproc docbook-xsl/html/docbook.xsl manual.xml > manual.html;;
		
	pdf)
		echo "Generating PDF Manual...";

		if [ -e manual.pdf ]; then
			rm -f manual.pdf;
		fi

		fop -xsl docbook-xsl/fo/docbook.xsl -xml manual.xml -pdf manual.pdf

		rm -f manual.fo;;
		
	test-saxon) 
		echo "Testing documentation (if you see no errors, everything is good)...";
		
		java sax.SAXCount manual.xml;;
		
	test-xmllint)
		echo "Testing documentation (if you see no errors, everything is good)...";

		xmllint --valid --noout manual.xml;;		
	
	help)
		echo "Gallery Documentation Generation Script";
		echo "---------------------------------------";
		echo "Usage: ./gen [option]";
		echo "";		
		echo "Options:";
		echo "html          Generate HTML documents";
		echo "bightml       Generate one big HTML document";
		echo "pdf           Generate a PDF (requires fop)";
		echo "test-saxon    Test for XML errors using saxon";
		echo "test-xmllint  Test for XML errors using xmllint";
		echo "clean         Remove all generated manuals (created by html, bightml, etc..)";
		echo "help          Display this help page";;

	clean)
		echo "Deleting generated documentation...";
                
                #Remove files
		rm -rf manual.pdf manual.html;
                
                #Remove directories
                rm -rf html dist;;
		
	*)
		echo "Invalid Action.  Type './gen help' for help";;
esac
